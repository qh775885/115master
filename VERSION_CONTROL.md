# 🔧 简单版本控制

## 📋 版本规则

**格式**: `原版本-mod.主版本.次版本.修订版本`  
**示例**: `1.6.1-mod.0.2.1`

## 🚀 简单使用

### 快速提交
```bash
# 提交当前改动（不创建版本）
npm run commit "修复播放问题"
```

### 发布版本
```bash
# 发布修复版本 (0.2.1 → 0.2.2)
npm run release:patch

# 发布功能版本 (0.2.1 → 0.3.0)  
npm run release:minor

# 发布重大版本 (0.2.1 → 1.0.0)
npm run release:major
```

### 查看版本
```bash
# 查看所有版本
npm run versions

# 回滚到指定版本  
npm run rollback 1.6.1-mod.0.2.0
```

## 🔄 完整工作流程

### 1. 开发阶段
```bash
# 正常开发...
# 修改代码、测试功能
```

### 2. 提交发布
```bash
# 方式一：自动检测（推荐）
npm run commit "描述你的改动"

# 方式二：手动指定
npm run version:patch   # 或 minor/major
```

### 3. 自动完成
- ✅ 分析改动类型
- ✅ 递增版本号
- ✅ 更新 package.json
- ✅ 构建项目 (npm run build)
- ✅ Git 提交
- ✅ 创建版本标签
- ✅ 生成发布文件

## 📊 版本历史示例

```
v1.6.1-mod.0.1.0  ✨ 初始修改版本
v1.6.1-mod.0.1.1  🐛 修复TypeScript错误
v1.6.1-mod.0.2.0  ✨ 添加画质选择记忆
v1.6.1-mod.0.2.1  🐛 修复播放模式图标
v1.6.1-mod.0.3.0  ✨ 添加上下集导航
v1.6.1-mod.0.3.1  🐛 修复切换问题
```

## 🛡️ 安全机制

### 自动备份
- 每次发布自动创建 Git 标签
- 可随时回滚到任意版本
- 保留完整的变更历史

### 智能检测
- 自动分析代码改动
- 智能推荐版本类型
- 防止版本号混乱

### 错误恢复
```bash
# 如果发布有问题，立即回滚
npm run version:rollback 1.6.1-mod.0.2.0

# 查看可用版本
npm run version:list
```

## 🎯 最佳实践

1. **使用自动提交**: `npm run commit "改动描述"`
2. **描述要清楚**: 说明具体改动内容
3. **及时发布**: 不要累积太多改动
4. **测试后发布**: 确保功能正常
5. **保留历史**: 不要删除版本标签

## 📁 文件结构

```
scripts/
├── version-manager.js    # 版本管理核心
├── auto-commit.js       # 智能提交管理
└── ...

package.json             # 版本号存储
dist/                   # 构建输出
├── 115master.user.js   # 用户脚本
└── 115master.meta.js   # 元数据
```

---

**🎉 现在版本完全自动化管理，你不用担心版本控制问题了！**
